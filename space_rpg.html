<!DOCTYPE html>
<html lang="tr">
  <head>
    <meta charset="UTF-8" />
    <title>Zeta Primus â€“ Galaksi GÃ¶rev Sistemi</title>
    <style>
      :root {
        --bg: #050814;
        --panel: #101625;
        --panel-soft: #151d30;
        --accent: #4fd1c5;
        --accent-soft: rgba(79, 209, 197, 0.15);
        --text: #e4edf7;
        --muted: #9aa4c0;
        --danger: #f56565;
        --success: #68d391;
        --border: #2b3650;
        --radius: 14px;
      }

      * {
        box-sizing: border-box;
      }

      body {
        margin: 0;
        min-height: 100vh;
        font-family: system-ui, -apple-system, BlinkMacSystemFont, "Segoe UI",
          sans-serif;
        background: radial-gradient(circle at top, #1a2540 0, #050814 55%);
        color: var(--text);
        display: flex;
        justify-content: center;
        align-items: stretch;
        padding: 16px;
      }

      .app {
        width: 100%;
        max-width: 900px;
        background: linear-gradient(
          145deg,
          rgba(15, 23, 42, 0.96),
          rgba(5, 10, 25, 0.98)
        );
        border-radius: 24px;
        border: 1px solid rgba(148, 163, 184, 0.35);
        box-shadow: 0 24px 60px rgba(15, 23, 42, 0.9),
          0 0 0 1px rgba(15, 23, 42, 0.9);
        padding: 20px 20px 18px;
        display: flex;
        flex-direction: column;
        gap: 14px;
      }

      header {
        display: flex;
        justify-content: space-between;
        align-items: center;
        gap: 12px;
        padding-bottom: 8px;
        border-bottom: 1px solid var(--border);
      }

      header h1 {
        font-size: 1.4rem;
        margin: 0;
        letter-spacing: 0.06em;
        text-transform: uppercase;
        display: flex;
        align-items: center;
        gap: 8px;
      }

      header h1 span.logo {
        display: inline-flex;
        width: 26px;
        height: 26px;
        border-radius: 999px;
        border: 1px solid var(--accent);
        align-items: center;
        justify-content: center;
        font-size: 16px;
        color: var(--accent);
        box-shadow: 0 0 10px rgba(79, 209, 197, 0.7);
      }

      header p {
        margin: 0;
        font-size: 0.78rem;
        color: var(--muted);
        max-width: 260px;
      }

      .controls {
        display: flex;
        flex-wrap: wrap;
        gap: 8px;
        justify-content: flex-end;
        align-items: center;
      }

      .btn {
        border: 1px solid rgba(148, 163, 184, 0.6);
        background: radial-gradient(circle at top, #1f2937 0, #020617 60%);
        color: var(--text);
        padding: 6px 10px;
        border-radius: 999px;
        font-size: 0.78rem;
        cursor: pointer;
        display: inline-flex;
        align-items: center;
        gap: 6px;
        transition: all 0.15s ease;
        white-space: nowrap;
      }

      .btn span.icon {
        font-size: 0.9rem;
      }

      .btn-primary {
        border-color: rgba(79, 209, 197, 0.9);
        color: var(--accent);
        box-shadow: 0 0 12px rgba(79, 209, 197, 0.45);
      }

      .btn:hover {
        transform: translateY(-1px);
        box-shadow: 0 0 18px rgba(15, 23, 42, 0.8);
      }

      .btn-primary:hover {
        box-shadow: 0 0 16px rgba(79, 209, 197, 0.7),
          0 0 0 1px rgba(79, 209, 197, 0.8);
      }

      input[type="file"] {
        font-size: 0.75rem;
        color: var(--muted);
        max-width: 200px;
      }

      main {
        display: grid;
        grid-template-columns: minmax(0, 2.2fr) minmax(0, 1.4fr);
        gap: 12px;
        margin-top: 4px;
        flex: 1;
        min-height: 0;
      }

      @media (max-width: 780px) {
        main {
          grid-template-columns: minmax(0, 1fr);
        }
      }

      .panel {
        background: radial-gradient(
          circle at top left,
          rgba(148, 163, 184, 0.1) 0,
          var(--panel) 60%
        );
        border-radius: var(--radius);
        border: 1px solid var(--border);
        padding: 12px 12px 10px;
        display: flex;
        flex-direction: column;
        gap: 9px;
      }

      .panel-header {
        display: flex;
        justify-content: space-between;
        align-items: center;
        gap: 8px;
      }

      .panel-header h2 {
        margin: 0;
        font-size: 0.9rem;
        text-transform: uppercase;
        letter-spacing: 0.08em;
        color: var(--muted);
      }

      .badge {
        font-size: 0.7rem;
        padding: 3px 8px;
        border-radius: 999px;
        border: 1px solid rgba(148, 163, 184, 0.4);
        color: var(--muted);
      }

      #step-title {
        font-size: 1.06rem;
        margin: 0;
        color: var(--text);
      }

      #step-type {
        font-size: 0.75rem;
        text-transform: uppercase;
        letter-spacing: 0.1em;
        color: var(--muted);
      }

      #step-text {
        white-space: pre-wrap;
        font-size: 0.9rem;
        line-height: 1.5;
      }

      #ui-area {
        margin-top: 6px;
        display: flex;
        flex-direction: column;
        gap: 6px;
      }

      .choice-list {
        display: flex;
        flex-direction: column;
        gap: 6px;
      }

      .choice-btn {
        border-radius: 10px;
        padding: 7px 10px;
        border: 1px solid rgba(148, 163, 184, 0.5);
        background: var(--panel-soft);
        cursor: pointer;
        display: flex;
        align-items: center;
        gap: 8px;
        font-size: 0.85rem;
        text-align: left;
        transition: all 0.15s ease;
      }

      .choice-btn strong {
        font-size: 0.78rem;
        color: var(--accent);
      }

      .choice-btn:hover {
        border-color: var(--accent);
        box-shadow: 0 0 10px var(--accent-soft);
        transform: translateY(-1px);
      }

      .choice-result {
        margin-top: 3px;
        padding: 7px 9px;
        background: rgba(79, 209, 197, 0.05);
        border-radius: 8px;
        font-size: 0.82rem;
        color: var(--accent);
        border: 1px solid rgba(79, 209, 197, 0.3);
      }

      .dice-info {
        font-size: 0.82rem;
        color: var(--muted);
      }

      .dice-result {
        font-size: 0.9rem;
        margin-top: 4px;
      }

      .dice-result.success {
        color: var(--success);
      }

      .dice-result.fail {
        color: var(--danger);
      }

      #log {
        flex: 1;
        min-height: 0;
        font-size: 0.78rem;
        color: var(--muted);
        background: radial-gradient(
          circle at bottom right,
          rgba(15, 23, 42, 0.1) 0,
          var(--panel-soft) 60%
        );
        border-radius: 10px;
        padding: 7px 8px;
        overflow-y: auto;
        border: 1px dashed rgba(148, 163, 184, 0.4);
      }

      #log p {
        margin: 0 0 4px;
      }

      footer {
        font-size: 0.7rem;
        color: var(--muted);
        display: flex;
        justify-content: space-between;
        align-items: center;
        gap: 8px;
        border-top: 1px solid var(--border);
        padding-top: 6px;
        margin-top: 2px;
      }

      footer span {
        opacity: 0.9;
      }

      .step-counter {
        font-size: 0.7rem;
        color: var(--muted);
      }
    </style>
  </head>
  <body>
    <div class="app">
      <header>
        <div>
          <h1><span class="logo">ğŸš€</span>Zeta Primus</h1>
          <p>
            3 farklÄ± galaksiden gelen iÅŸgal gÃ¼Ã§leri arasÄ±nda gÃ¶rev alan bir
            ajanÄ± oynuyorsun.
          </p>
        </div>
        <div class="controls">
          <label class="btn">
            <span class="icon">ğŸ“</span>
            <span>Dosyadan senaryo yÃ¼kle</span>
            <input
              id="file-input"
              type="file"
              accept=".json,.txt"
              style="display: none"
            />
          </label>
          <button id="load-sample" class="btn btn-primary">
            <span class="icon">âœ¨</span><span>Ã–rnek senaryoyu kullan</span>
          </button>
        </div>
      </header>

      <main>
        <!-- Sol: ana sahne -->
        <section class="panel">
          <div class="panel-header">
            <div>
              <div class="step-counter" id="step-counter">AdÄ±m: - / -</div>
              <h2>GÃ¶rev Sahnesi</h2>
            </div>
            <div id="step-type" class="badge">HazÄ±r</div>
          </div>

          <div>
            <h3 id="step-title">Senaryo yÃ¼klenmedi</h3>
            <p id="step-text">
              SaÄŸ Ã¼stteki butondan kendi <code>story.json</code> dosyanÄ±
              yÃ¼kleyebilir veya Ã¶rnek senaryoyu kullanabilirsin.
            </p>
          </div>

          <div id="ui-area"></div>
        </section>

        <!-- SaÄŸ: log paneli -->
        <aside class="panel">
          <div class="panel-header">
            <h2>GÃ¶rev GÃ¼nlÃ¼ÄŸÃ¼</h2>
            <span class="badge" id="story-status">Senaryo yok</span>
          </div>
          <div id="log">
            <p>HazÄ±rsan bir senaryo yÃ¼kleyerek baÅŸla.</p>
          </div>
        </aside>
      </main>

      <footer>
        <span
          >Senaryolar Python sÃ¼rÃ¼mÃ¼ndekiyle aynÄ± JSON formatÄ±nÄ± kullanÄ±r (<code
            >type: narrative | choice | roll | end</code
          >).</span
        >
        <span id="footer-msg"></span>
      </footer>
    </div>

    <script>
      // --- Ã–RNEK SENARYO (story.json ile aynÄ±) --------------------------
      const sampleStory = [
        {
          id: 1,
          title: "Zeta Primus'a Ä°niÅŸ",
          text: "ÃœÃ§ galaksinin de gÃ¶zÃ¼ bu gezegende. Orion Ä°ttifakÄ±, Lyra Kollektifi ve Drakon BirliÄŸi, gezegenin farklÄ± bÃ¶lgelerini iÅŸgal etmiÅŸ durumda.\n\nSen, tarafsÄ±z Ä°stasyon KomutanlÄ±ÄŸÄ± adÄ±na gÃ¶rev alan bir saha ajanÄ±sÄ±n. Åu an gezegen yÃ¶rÃ¼ngesindeki kÃ¼Ã§Ã¼k bir Ã¼s gemisindesin. Ä°lk gÃ¶revin, yÃ¼zeye inip gÃ¼venli bÃ¶lgedeki operasyon Ã¼ssÃ¼ne ulaÅŸmak.",
          type: "narrative",
        },
        {
          id: 2,
          title: "GÃ¼venli BÃ¶lgeye YaklaÅŸÄ±m",
          text: "KeÅŸif shuttle'Ä±na biniyorsun. Ä°niÅŸ rotasÄ± boyunca Ã¼Ã§ fraksiyonun da sinyallerini alÄ±yorsun.\n\nOrion Ä°ttifakÄ± kuzey manyetik alanÄ±nÄ± kontrol ediyor. Lyra Kollektifi batÄ±daki veri kulelerini ele geÃ§irmiÅŸ. Drakon BirliÄŸi ise gÃ¼neydeki eski maden hatlarÄ±nÄ± kullanÄ±yor.\n\nÄ°stasyon, hangi hatta yaklaÅŸacaÄŸÄ±na senin karar vermeni istiyor.",
          type: "choice",
          choices: [
            {
              key: "A",
              text: "Orion Ä°ttifakÄ±'nÄ±n kontrol ettiÄŸi kuzey koridoruna yaklaÅŸ.",
              result_text:
                "Kuzey koridoru daha iyi korunuyor ama aynÄ± zamanda daha dÃ¼zenli. RadarÄ±nda net devriye rotalarÄ± gÃ¶rÃ¼yorsun.",
            },
            {
              key: "B",
              text: "Lyra Kollektifi'nin veri kulelerinin yakÄ±nÄ±ndan dolaÅŸ.",
              result_text:
                "Veri kuleleri parazit yayÄ±yor, sensÃ¶rlerin bozuluyor ama keÅŸfedilme riskin daha dÃ¼ÅŸÃ¼k.",
            },
            {
              key: "C",
              text: "Drakon BirliÄŸi'nin maden hatlarÄ±na paralel alÃ§ak uÃ§uÅŸ yap.",
              result_text:
                "Maden tÃ¼nelleri yÃ¼zeyi parÃ§alamÄ±ÅŸ. Riskli ama araya saklanabileceÄŸin Ã§ok kÄ±rÄ±k yÃ¼zey var.",
            },
          ],
        },
        {
          id: 3,
          title: "Atmosfere GiriÅŸ - Ä°lk Zar",
          text: "Atmosfere girerken shuttle ÅŸiddetle sallanÄ±yor. SeÃ§tiÄŸin rotaya gÃ¶re savunma sistemleri seni taramaya baÅŸlÄ±yor.\n\nÅimdi pilotaj becerine gÃ¼venmen gerekiyor. KÃ¼Ã§Ã¼k manevralarla savunma aÄŸlarÄ±nÄ±n arasÄ±ndan sÄ±yrÄ±lmaya Ã§alÄ±ÅŸacaksÄ±n.",
          type: "roll",
          dice: "d6",
          target: 4,
          success_text:
            "Shuttle'Ä± ustaca kontrol ediyorsun. BirkaÃ§ lazer izini kalkanlarÄ±n emiyor ama ciddi bir hasar almadan gÃ¼venli bÃ¶lgenin yakÄ±nlarÄ±na inmeyi baÅŸarÄ±yorsun.",
          fail_text:
            "Savunma sistemleri shuttle'Ä± kilitliyor. Acil kaÃ§Ä±ÅŸ manevrasÄ± yapÄ±p planlanandan daha uzak, yarÄ± dÃ¼ÅŸman hattÄ±nda bir noktaya sert iniÅŸ yapÄ±yorsun. GÃ¶rev daha zor hale geldi.",
        },
        {
          id: 4,
          title: "Ä°lk GÃ¶rev Brifingi",
          text: "Nihayet yÃ¼zeye ulaÅŸtÄ±n. Zemin, eski bombardÄ±man kraterleriyle dolu. Ufukta Orion, Lyra ve Drakon bayraklarÄ±nÄ± aynÄ± anda gÃ¶rebiliyorsun.\n\nGÃ¼venli bÃ¶lgedeki saha komutanÄ±, ilk gÃ¶revin iÃ§in Ã¼Ã§ seÃ§enek sunuyor:\n- Bir iletiÅŸim rÃ¶lesi arÄ±zalanmÄ±ÅŸ, onarÄ±lmasÄ± gerekiyor.\n- Lyra'nÄ±n veri kulesinden ÅŸifreli paket almak mÃ¼mkÃ¼n olabilir.\n- Drakon devriyesi, maden hattÄ± yakÄ±nÄ±nda kaybolmuÅŸ; enkazÄ± bulmak stratejik bilgi saÄŸlayabilir.\n\nBu noktadan sonra senaryoyu uzatmak tamamen sana kalmÄ±ÅŸ. story.json dosyasÄ±na yeni adÄ±mlar ekleyerek devam edebilirsin.",
          type: "choice",
          choices: [
            {
              key: "A",
              text: "Ä°letiÅŸim rÃ¶lesini onarma gÃ¶revini kabul et.",
              result_text:
                "Komutan, sana eski model bir bakÄ±m dronu ve koordinatlarÄ± veriyor.",
            },
            {
              key: "B",
              text: "Lyra veri kulesinden paket alma gÃ¶revini seÃ§.",
              result_text:
                "Gizlilik Ã¶ncelikli. Hafif zÄ±rh ve sinyal bozucu modÃ¼ller hazÄ±rlanÄ±yor.",
            },
            {
              key: "C",
              text: "Drakon devriyesinin enkazÄ±nÄ± araÅŸtÄ±rma gÃ¶revini al.",
              result_text:
                "Bu gÃ¶rev riskli ama Ã¶dÃ¼lÃ¼ bÃ¼yÃ¼k olabilir. SensÃ¶r paketleri shuttle'a yÃ¼kleniyor.",
            },
          ],
        },
        {
          id: 5,
          title: "BÃ¶lÃ¼m Sonu",
          text: "Buraya kadar ilk bÃ¶lÃ¼m bitti. Buradan sonrasÄ± iÃ§in yeni adÄ±mlar ekleyerek haftalÄ±k gÃ¶revlerini oluÅŸturabilirsin.\n\nHer yeni gÃ¶rev iÃ§in yeni 'id' deÄŸerleriyle yeni nesneler ekle.",
          type: "end",
        },
      ];

      // --- OYUN DURUMU ---------------------------------------------------
      let story = [];
      let currentIndex = 0;

      const stepTitleEl = document.getElementById("step-title");
      const stepTextEl = document.getElementById("step-text");
      const stepTypeEl = document.getElementById("step-type");
      const uiAreaEl = document.getElementById("ui-area");
      const logEl = document.getElementById("log");
      const storyStatusEl = document.getElementById("story-status");
      const footerMsgEl = document.getElementById("footer-msg");
      const stepCounterEl = document.getElementById("step-counter");

      function log(message) {
        const p = document.createElement("p");
        p.textContent = message;
        logEl.appendChild(p);
        logEl.scrollTop = logEl.scrollHeight;
      }

      function setStory(newStory, label) {
        story = newStory || [];
        currentIndex = 0;

        if (!Array.isArray(story) || story.length === 0) {
          stepTitleEl.textContent = "Senaryo yÃ¼klenemedi";
          stepTextEl.textContent = "GeÃ§erli bir adÄ±m listesi bulunamadÄ±.";
          uiAreaEl.innerHTML = "";
          storyStatusEl.textContent = "Hata";
          footerMsgEl.textContent = "";
          stepCounterEl.textContent = "AdÄ±m: - / -";
          return;
        }

        storyStatusEl.textContent = label || "Senaryo yÃ¼klendi";
        footerMsgEl.textContent = `Toplam ${story.length} adÄ±m.`;
        logEl.innerHTML = "";
        log(`â–¶ ${label || "Senaryo"} yÃ¼klendi.`);
        renderStep();
      }

      function renderStep() {
        uiAreaEl.innerHTML = "";
        if (!story || currentIndex < 0 || currentIndex >= story.length) {
          stepTitleEl.textContent = "Senaryo bitti";
          stepTextEl.textContent = "Yeni bir senaryo yÃ¼kleyebilirsin.";
          stepTypeEl.textContent = "Bitti";
          stepCounterEl.textContent = `AdÄ±m: ${story.length} / ${story.length}`;
          return;
        }

        const step = story[currentIndex];
        const type = (step.type || "narrative").toLowerCase();

        stepTitleEl.textContent = step.title || `AdÄ±m ${currentIndex + 1}`;
        stepTextEl.textContent = step.text || "";
        stepCounterEl.textContent = `AdÄ±m: ${currentIndex + 1} / ${
          story.length
        }`;
        stepTypeEl.textContent =
          type === "narrative"
            ? "AnlatÄ±m"
            : type === "choice"
            ? "SeÃ§im"
            : type === "roll"
            ? "Zar kontrolÃ¼"
            : type === "end"
            ? "BÃ¶lÃ¼m sonu"
            : type;

        if (type === "narrative") {
          const btn = document.createElement("button");
          btn.className = "btn btn-primary";
          btn.textContent = "Devam et";
          btn.onclick = () => {
            log(`â€¢ AnlatÄ±m okundu â†’ sonraki adÄ±ma geÃ§ildi.`);
            currentIndex++;
            renderStep();
          };
          uiAreaEl.appendChild(btn);
          return;
        }

        if (type === "choice") {
          const list = document.createElement("div");
          list.className = "choice-list";
          let resultBox = null;

          (step.choices || []).forEach((choice) => {
            const btn = document.createElement("button");
            btn.className = "choice-btn";
            btn.innerHTML = `<strong>${choice.key || "?"}</strong><span>${
              choice.text || ""
            }</span>`;
            btn.onclick = () => {
              if (!resultBox) {
                resultBox = document.createElement("div");
                resultBox.className = "choice-result";
                uiAreaEl.appendChild(resultBox);
              }
              resultBox.textContent = choice.result_text || "SeÃ§im uygulandÄ±.";
              log(`â€¢ SeÃ§im: ${choice.key}) ${choice.text}`);
            };
            list.appendChild(btn);
          });

          uiAreaEl.appendChild(list);

          const nextBtn = document.createElement("button");
          nextBtn.className = "btn btn-primary";
          nextBtn.textContent = "Sonraki adÄ±ma geÃ§";
          nextBtn.onclick = () => {
            currentIndex++;
            renderStep();
          };
          uiAreaEl.appendChild(nextBtn);
          return;
        }

        if (type === "roll") {
          const diceSpec = step.dice || "d6";
          const target = typeof step.target === "number" ? step.target : 4;

          const info = document.createElement("div");
          info.className = "dice-info";
          info.textContent = `${diceSpec} zarÄ± atÄ±lacak. Hedef â‰¥ ${target}.`;
          uiAreaEl.appendChild(info);

          const resultP = document.createElement("div");
          resultP.className = "dice-result";
          uiAreaEl.appendChild(resultP);

          const rollBtn = document.createElement("button");
          rollBtn.className = "btn btn-primary";
          rollBtn.innerHTML = `<span class="icon">ğŸ²</span><span>Zar at</span>`;
          rollBtn.onclick = () => {
            const roll = rollDice(diceSpec);
            const success = roll >= target;
            resultP.className = "dice-result " + (success ? "success" : "fail");
            resultP.textContent =
              `Zar sonucu: ${roll} â†’ ` + (success ? "BAÅARI" : "BAÅARISIZLIK");

            log(
              `â€¢ Zar (${diceSpec}) â†’ ${roll} (${
                success ? "baÅŸarÄ±lÄ±" : "baÅŸarÄ±sÄ±z"
              })`
            );

            const text = success ? step.success_text : step.fail_text;
            if (text) {
              const extra = document.createElement("div");
              extra.style.marginTop = "4px";
              extra.style.fontSize = "0.82rem";
              extra.textContent = text;
              uiAreaEl.appendChild(extra);
            }
          };
          uiAreaEl.appendChild(rollBtn);

          const nextBtn = document.createElement("button");
          nextBtn.className = "btn";
          nextBtn.style.marginTop = "4px";
          nextBtn.textContent = "Sonraki adÄ±ma geÃ§";
          nextBtn.onclick = () => {
            currentIndex++;
            renderStep();
          };
          uiAreaEl.appendChild(nextBtn);
          return;
        }

        if (type === "end") {
          const msg = document.createElement("div");
          msg.className = "dice-info";
          msg.textContent =
            "BÃ¶lÃ¼m sonuna ulaÅŸtÄ±n. Yeni adÄ±mlar ekleyerek senaryoyu uzatabilirsin.";
          uiAreaEl.appendChild(msg);

          const restartBtn = document.createElement("button");
          restartBtn.className = "btn";
          restartBtn.textContent = "BaÅŸtan oyna";
          restartBtn.onclick = () => {
            currentIndex = 0;
            renderStep();
          };
          uiAreaEl.appendChild(restartBtn);
          return;
        }
      }

      function rollDice(diceSpec) {
        const spec = diceSpec.toLowerCase().trim();
        let count, sides;
        if (spec.startsWith("d")) {
          count = 1;
          sides = parseInt(spec.slice(1), 10);
        } else {
          const parts = spec.split("d");
          count = parseInt(parts[0], 10);
          sides = parseInt(parts[1], 10);
        }
        let total = 0;
        for (let i = 0; i < count; i++) {
          total += Math.floor(Math.random() * sides) + 1;
        }
        return total;
      }

      // --- OLAYLAR ------------------------------------------------------
      document.getElementById("load-sample").addEventListener("click", () => {
        setStory(sampleStory, "Ã–rnek senaryo");
      });

      document.getElementById("file-input").addEventListener("change", (e) => {
        const file = e.target.files[0];
        if (!file) return;

        const reader = new FileReader();
        reader.onload = (event) => {
          try {
            const json = JSON.parse(event.target.result);
            setStory(json, file.name);
          } catch (err) {
            alert("JSON parse hatasÄ±: " + err.message);
          }
        };
        reader.readAsText(file, "utf-8");
      });
    </script>
  </body>
</html>
